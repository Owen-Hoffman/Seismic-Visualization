<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset='utf-8'>
  <title>Tutorial 2: Real Data</title>
  <style>
    div.seismograph {
      height: 300px;
    }
  </style>
</head>

<body>
  <h3>Tutorial 2: Real Data</h3>
  <h3>A Seismograph!</h3>
  <p id="testing"></p>
  <div class="seismograph" id="myseismograph">
  </div>

  <script src="https://www.seis.sc.edu/downloads/seisplotjs/seisplotjs_2.0.1_standalone.js"></script>
  <script>
    function getSeismicData(myNetworkCode, stationCode, locationCode, channelCode) {
      const plotEnd = seisplotjs.moment.utc().endOf('hour').add(1, 'millisecond');
            if (plotEnd.hour() % 2 === 1) { plotEnd.add(1, 'hour'); }
      let timeWindow = new seisplotjs.util.StartEndDuration(null, plotEnd, seisplotjs.moment.duration(1, 'day'));
      let dsQuery = new seisplotjs.fdsndataselect.DataSelectQuery();
      dsQuery.networkCode(myNetworkCode)
        .stationCode(stationCode)
        .locationCode(locationCode)
        .channelCode(channelCode)
        .timeWindow(timeWindow);
      return dsQuery.querySeismograms().then(seisArray => {
        let seismogram = seisArray[0];
        let div = seisplotjs.d3.select('div#myseismograph');
        let seisConfig = new seisplotjs.seismographconfig.SeismographConfig();
        seisConfig.title = seismogram.codes();
        let seisData = seisplotjs.seismogram.SeismogramDisplayData.fromSeismogram(seismogram);
        let graph = new seisplotjs.seismograph.Seismograph(div, seisConfig, seisData);
        // graph.draw();
        // console.log(graph);
        var graphText = JSON.stringify(graph);
        var graphText2 = JSON.stringify(seisData);
        return graphText2;
      });
    }
    getSeismicData('CO', 'HODGE', '00', 'LHZ').then(data => {console.log(data);});

  </script>
</body>

</html>